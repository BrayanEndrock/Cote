<div data-section-type="collection-template">
 {% paginate collection.products by 10000 %}
  
  
<style>
  .cleaner-safer-banner > * {
  background: #F4EEDE;
  
  
}
  
 
  .cleaner-safer-banner {
  	display: none;
  
  }


.cleaner-safer-banner .cleaner-safer-banner__mobile-row {
    display: flex;
    flex-direction: row;
    column-gap: 60px;
    margin: auto;
}



 @media screen and (max-width:768px) {
     .cleaner-safer-banner .cleaner-safer-banner__grid {
        flex-direction: column !important;
       row-gap: 25px;
   }
   
   
}
  
 @media screen and (max-width:768px) {
  .cleaner-safer-banner .cleaner-safer-banner__mobile-row {
    max-width: 100vw;
 
/*display: grid; grid-template-columns: repeat(auto-fit,minmax(124px,1fr)); */
    gap: 0 15px;
    /*grid-auto-flow: column;
    overflow: scroll;
    -webkit-overflow-scrolling: touch;
    scroll-snap-type: x mandatory;*/
  }
  
  .cleaner-safer-banner .cleaner-safer-banner__mobile-row:nth-child(2) {
        padding-left: 24px;
    padding-right:24px;
    
  }
  
  .cleaner-safer-banner .cleaner-safer-banner__container {
  	overflow-x:scroll;
  
  }
  
  
  }    

  
  
 @media screen and (max-width:768px) {
     .cleaner-safer-banner .cleaner-safer-banner__desktop-only-copy {
       display: none;
     }
 }

@media screen and (max-width:768px) {
  .cleaner-safer-banner .cleaner-safer-banner__mobile-row {
    column-gap: 15px;
  }
}

@media screen and (max-width:768px) {
  .cleaner-safer-banner .cleaner-safer-banner__bullet-point {
    min-width: 86px;
    
  }}
.cleaner-safer-banner .cleaner-safer-banner__grid {
  display: flex;
  flex-direction:row;
  column-gap: 60px; /*might be worth excluding*/
  margin: auto;

}

.cleaner-safer-banner .cleaner-safer-banner__tagline {
  font-family: Playfair Display;
font-style: normal;
font-weight: normal;
font-size: 18px;
line-height: 32px;
/* identical to box height, or 178% */

  display: flex;
  
letter-spacing: 0.03em;
  align-items:center;

color: #3E5461;
  padding-top: 6px;
  text-decoration: underline;
  text-underline-offset:7px;
  text-decoration-color: #DED1AF;
}

.cleaner-safer-banner .cleaner-safer-banner__container {
  padding: 27px 0;
  display: flex;
  margin-bottom: 0;
  
}

.cleaner-safer-banner .cleaner-safer-banner__bullet-point {
  text-align: center;
  max-width: 86px;
}

.cleaner-safer-banner .cleaner-safer-banner__bullet-point p {
margin-top: 12px;
  margin-bottom: 0;
  font-style: normal;
font-weight: normal;
font-size: 12px;
line-height: 16px;
/* identical to box height, or 133% */


text-align: center;
letter-spacing: 0.03em;
text-transform: capitalize;

color: #3E4B57;}
  
.cleaner-safer-banner .cleaner-safer-banner__bullet-point img {
      max-width: 32px;
  display: block;
  margin: auto;

}
  
  .promo-banner {
	background: #EA9F84;
	padding: 20px 0 20px;
    text-align: center;
}
  
  .promo-banner-copy {
    font-family: Roboto;
font-style: normal;
    font-size: 16px;
line-height: 18px;
    letter-spacing: 0.03em;

color: #FFFFFF;
    margin-bottom: 0;
  
}

  @media screen and (max-width: 768px) {
    .promo-banner {
       padding: 12px 15px;
    }
    .promo-banner .promo-banner-copy span {
    	display: inline ;
    }
}
  
   .promo-banner  span {
    	display: none;
    }


</style>	
    <a class="cleaner-safer-banner" href="{{section.settings.banner_link}}">
      <div class="cleaner-safer-banner__container">
        <div class="cleaner-safer-banner__grid">
          <div class="cleaner-safer-banner__mobile-row">
          <div class="cleaner-safer-banner__item cleaner-safer-banner__tagline">
			Cleaner safer beauty
          </div>
          </div>
          
		  <div class="cleaner-safer-banner__mobile-row">
            <div class="cleaner-safer-banner__item cleaner-safer-banner__bullet-point">
              <img
                src="{{ section.settings.icon-1 |  img_url: '300x300' }}"
                width="100%"
                alt=""
              />
              <p>
                {{section.settings.text_icon-1}}</p>            
            </div> 
            <div class="cleaner-safer-banner__item cleaner-safer-banner__bullet-point">
              <img
                src="{{ section.settings.icon-2 |  img_url: '300x300' }}"
                width="100%"
                alt=""
              />
              <p>
                {{section.settings.text_icon-2}}</p>            
            </div> 

            <div class="cleaner-safer-banner__item cleaner-safer-banner__bullet-point">
              <img
                src="{{ section.settings.icon-3 |  img_url: '300x300' }}"
                width="100%"
                alt=""
              />
              <p>
                {{section.settings.text_icon-3}}</p>            
            </div> 
            <div class="cleaner-safer-banner__item cleaner-safer-banner__bullet-point">
              <img
                src="{{ section.settings.icon-4 |  img_url: '300x300' }}"
                width="100%"
                alt=""
              />
              <p>
                {{section.settings.text_icon-4}}</p>            
            </div> 
            <div class="cleaner-safer-banner__item cleaner-safer-banner__bullet-point">
              <img
                src="{{ section.settings.icon-5 |  img_url: '300x300' }}"
                width="100%"
                alt=""
              />
              <p>
                {{section.settings.text_icon-5}}</p>            
            </div> 
          </div>
         
        </div>
      </div>
    </a>
  <div class=" {% unless section.settings.banner-visible %} hide  {% endunless %} promo-banner">
    <p class="promo-banner-copy"> {{section.settings.promobanner-copy}} </p>
  </div>
  
<div class="container">
  <div class="page-header cf">
    {% if section.settings.coll_desc_pos == 'below' %}
    <h1 class="majortitle">{{ collection.title | escape }}</h1>
    {% endif %}

    {% if collection.description != blank %}
    <div class="user-content lightly-spaced-row {% if settings.lightbox_imgs %}lightboximages{% endif %}">
      {{ collection.description }}
    </div>
    {% endif %}

    {% if section.settings.coll_desc_pos == 'above' %}
    <h1 class="majortitle">{{ collection.title | escape }}</h1>
    {% endif %}
    
    {% comment %} Which tags should we show, and group them into categories {% endcomment %}
    {% assign show_normal_filter = false %}
    {% assign show_custom_filter_1 = false %}
    {% assign show_custom_filter_2 = false %}

    {% if section.settings.show_tagfilt_custom1 %}
    {%- assign custom_tag_arr1 = section.settings.tagfilt_custom1_tags | downcase | replace: ', ',',' | split: ',' -%}
    {%- capture filter1_html -%}
    
    {%- for s_tag in custom_tag_arr1 -%}
	    {%- for c_tag in collection.all_tags -%}
			{%- assign s_tag_lower = s_tag | downcase -%}
			{%- assign c_tag_lower = c_tag | downcase -%}
    
			{%- unless tag contains 'meta-' -%}
    			{%- if s_tag_lower == c_tag_lower -%}
					{%- assign show_custom_filter_1 = true -%}
						{%- if current_tags contains c_tag -%}
							<li class="active" data-tag="{{c_tag | handleize}}">{{ c_tag | append: ' <span class="x">&times;</span>' | link_to_remove_tag: c_tag }}</li>
						{%- else -%}
							<li data-tag="{{c_tag | handleize}}">{{ c_tag | link_to_add_tag: c_tag }}</li>
						{%- endif -%}
    			{%- endif -%}
    		{%- endunless -%}
	    {%- endfor -%}
    {%- endfor -%}
    
    {%- endcapture -%}
    {% endif %}

    {% if section.settings.show_tagfilt_custom2 %}
    {%- assign custom_tag_arr2 = section.settings.tagfilt_custom2_tags | downcase | replace: ', ',',' | split: ',' -%}
    {%- capture filter2_html -%}
    {%- for tag in collection.all_tags -%}
      {%- unless tag contains 'meta-' -%}
      {%- assign tag_lower = tag | downcase -%}
      {%- if custom_tag_arr2 contains tag_lower -%}
        {%- assign show_custom_filter_2 = true -%}
        {%- if current_tags contains tag -%}
        <li class="active" data-tag="{{tag | handleize}}">{{ tag | append: ' <span class="x">&times;</span>' | link_to_remove_tag: tag }}</li>
        {%- else -%}
        <li data-tag="{{tag | handleize}}">{{ tag | link_to_add_tag: tag }}</li>
        {%- endif -%}
      {%- endif -%}
      {%- endunless -%}
    {%- endfor -%}
    {%- endcapture -%}
    {% endif %}

    {% if section.settings.coll_show_tags %}
    {%- capture filter_html -%}
    {%- for tag in collection.all_tags -%}
      {%- unless tag contains 'meta-' or custom_tag_arr1 contains tag or custom_tag_arr2 contains tag -%}
        {%- assign show_normal_filter = true -%}
        {%- if current_tags contains tag -%}
        <li class="active" data-tag="{{tag | handleize}}">{{ tag | append: ' <span class="x">&times;</span>' | link_to_remove_tag: tag }}</li>
        {%- else -%}
        <li data-tag="{{tag | handleize}}">{{ tag | link_to_add_tag: tag }}</li>
        {%- endif -%}
      {%- endunless -%}
    {%- endfor -%}
    {%- endcapture -%}
    {% endif %}

{% if collection.title != "All" %}
    <div class="filters">
      {% if show_normal_filter %}
      <a href="#" class="tags" data-toggle-target=".tags.nav-row.cat-normal">{{ 'collections.filtering.filter' | t }} <span class="state">+</span></a>
      {% endif %}

      {% if show_custom_filter_1 %}
      <a href="#" class="tags hidden" data-toggle-target=".tags.nav-row.cat-custom-1">{{ section.settings.tagfilt_custom1_name | escape }} <span class="state">+</span></a>
      {% endif %}

      {% if show_custom_filter_2 %}
      <a href="#" class="tags" data-toggle-target=".tags.nav-row.cat-custom-2">{{ section.settings.tagfilt_custom2_name | escape }} <span class="state">+</span></a>
      {% endif %}

      {% if section.settings.coll_show_sort %}
      <span class="sort tags">
        <label for="sort-by">{{ 'collections.sorting.title' | t }}</label>
        <span class="styled-select styled-select--small">
          <select id="sort-by" data-initval="{{ collection.sort_by | default: collection.default_sort_by  }}">
            {% if section.settings.coll_show_feat %}<option value="manual">{{ 'collections.sorting.featured' | t }}</option>{% endif %}
            <option value="price-ascending">{{ 'collections.sorting.price_ascending' | t }}</option>
            <option value="price-descending">{{ 'collections.sorting.price_descending' | t }}</option>
<!--             <option value="title-ascending">{{ 'collections.sorting.az' | t }}</option>
            <option value="title-descending">{{ 'collections.sorting.za' | t }}</option>
            <option value="created-ascending">{{ 'collections.sorting.date_ascending' | t }}</option>
            <option value="created-descending">{{ 'collections.sorting.date_descending' | t }}</option> -->
            <option value="best-selling">{{ 'collections.sorting.best_selling' | t }}</option>
          </select>
        </span>
      </span>
      {% endif %}
    </div><!-- /.filters -->
{% endif %}
    
    <div class="social-area desktop-only">
      {% if section.settings.coll_gridstream_toggle %}
        <span class="view-as">
          <span class="view-as-label">{{ 'collections.general.view' | t }}</span>
          <a id="view-as-tiles" {% if section.settings.coll_gridstream_mode == 'grid' %}class="active"{% endif %} href="#">{{ 'collections.general.grid' | t }} <div class="fluff1"></div><div class="fluff2"></div><div class="fluff3"></div><div class="fluff4"></div></a>
          <a id="view-as-stream" {% if section.settings.coll_gridstream_mode == 'stream' %}class="active"{% endif %} href="#">{{ 'collections.general.list' | t }} <div class="fluff1"></div><div class="fluff2"></div></a>
        </span>
      {% endif %}
    </div>
  </div><!-- /.page-header -->
</div><!-- /.container -->

<!-- TOP COLOR FILTER MENU for ALL COLORS -->
{% if collection.title == "Non Toxic Nail Polish" %}
  {% if collection.metafields.global.is_nail_polish == 'true' %}
    {% assign excluded_tags = "Non Toxic" | split: "," %}
    <div class="multi-tag-row">
      <div class="tags nav-row cat-custom-1">
      <ul id="color_menu">      
      {%- for coll in collections -%}
        {% if coll.metafields.global.is_nail_polish == 'true' %}
        {% assign tag_color = coll.title | replace: "Nail Polish", "" | strip %}
        {% if excluded_tags contains tag_color %}
          {% continue %}
        {% endif %}
        <li data-tag="{{ tag_color | downcase }}s" data-order="{{ coll.metafields.global.color_order }}">
          <a href="{{coll.url}}">{{tag_color}}s</a>
        </li>
        {% endif %}
      {%- endfor -%}
      </ul>
      </div>
    </div>
    <script>
      jQuery('#color_menu li')
          .sort(function(a, b) { 
              var x = parseInt(a.getAttribute('data-order'));
              var y = parseInt(b.getAttribute('data-order'));
              return x < y ? -1 : 1; 
          })
          .appendTo('#color_menu');
    </script>
  {% endif %}
{% endif %}
<!-- TOP COLOR FILTER MENU -->
  
<div class="multi-tag-row">
    {% if show_normal_filter %}
    <div class="tags nav-row cat-normal {% unless filter_html contains 'class="active"' %}hidden{% endunless %}">
      <ul>
        {{ filter_html }}
      </ul>
    </div>
    {% endif %}

    {% if show_custom_filter_1 %}
    <div class="tags nav-row cat-custom-1">
      <ul>
        {{ filter1_html }}
      </ul>
    </div>
    {% endif %}

    {% if show_custom_filter_2 %}
    <div class="tags nav-row cat-custom-2 {% unless filter2_html contains 'class="active"' %}hidden{% endunless %}">
      <ul>
        {{ filter2_html }}
      </ul>
    </div>
    {% endif %}
</div><!-- /.multi-tag-row -->

{% if collection.products.size == 0 %}
    <div class="container"><h5 class="align-centre fully-spaced-row">{{ 'collections.general.no_matches' | t }}</h5></div>
{% else %}
    {% unless settings.use_fullwidth_layout %}<div class="container">{% endunless %}

    {%- if section.settings.coll_gridstream_toggle or section.settings.coll_gridstream_mode == 'stream' -%}
      {%- assign include_quick_buy_markup = true -%}
    {%- else -%}
      {%- assign include_quick_buy_markup = false -%}
    {%- endif -%}

    <div class="collection-listing{% if section.settings.coll_gridstream_mode == 'stream' %}-stream{% endif %} cf">
      <div class="product-list">
        {% for product in collection.products %}
        {% include 'bold-product' with product, hide_action: 'skip' %}
        {% include 'product-block' with product, include_quick_buy_markup: include_quick_buy_markup %}
        {% endfor %}
      </div>
    </div>
      <script>
      window.addEventListener('DOMContentLoaded', (event) => {
        let allAddToCarts=document.querySelectorAll('.add-to-cart-ajax')
        let trackAddToCarts = (event) => { ga('send', 'event', 'PLP Add to Cart', 'Click') }
        allAddToCarts.forEach(item => {
          item.addEventListener('click',trackAddToCarts)
        })
      });
    </script>

    {% unless settings.use_fullwidth_layout %}</div>{% endunless %}
{% endif %}

<!-- BOTTOM COLOR FILTER MENU -->
{% if collection.title != "Non Toxic Nail Polish" %}
  {% if collection.metafields.global.is_nail_polish == 'true' %}
    {% assign excluded_tags = "Non Toxic" | split: "," %}
    <div class="multi-tag-row bottom-row">
      <div class="tags nav-row cat-custom-1">
      <ul id="color_menu">      
      {%- for coll in collections -%}
        {% if coll.metafields.global.is_nail_polish == 'true' %}
        {% assign tag_color = coll.title | replace: "Nail Polish", "" | strip %}
        {% if excluded_tags contains tag_color %}
          {% continue %}
        {% endif %}
        <li data-tag="{{ tag_color | downcase }}s" data-order="{{ coll.metafields.global.color_order }}">
          <a href="{{coll.url}}">{{tag_color}}s</a>
        </li>
        {% endif %}
      {%- endfor -%}
      </ul>
      </div>
    </div>
    <script>
      jQuery('#color_menu li')
          .sort(function(a, b) { 
              var x = parseInt(a.getAttribute('data-order'));
              var y = parseInt(b.getAttribute('data-order'));
              return x < y ? -1 : 1; 
          })
          .appendTo('#color_menu');
    </script>
  {% endif %}
{% endif %}  
<!-- BOTTOM COLOR FILTER MENU -->
  
<div class="container">
  <div class="bottom-description">
      {{ collection.metafields.global.bottom_description }}
  </div>
</div>  
  
<!--<div class="container pagination-row">{% include 'pagination-control' %}</div>-->

{% endpaginate %}
</div>
<script>
const params = new URLSearchParams(window.location.search)
if (params.has('kw')) {
    document.querySelector('.majortitle').innerHTML = params.get('kw');
}  
</script>

{% schema %}
  {
    "name": "Collection pages",
    "settings": [
      {
        "type": "select",
        "id": "coll_desc_pos",
        "label": "Description position",
        "options": [
          {
            "value": "below",
            "label": "Below collection title"
          },
          {
            "value": "above",
            "label": "Above collection title"
          }
        ]
      },
      {
        "type": "checkbox",
        "id": "coll_show_sort",
        "label": "Show 'sort by' dropdown",
        "default": true
      },
      {
        "type": "checkbox",
        "id": "coll_show_feat",
        "label": "Show 'Featured' in sort by",
        "default": false
      },
      {
        "type": "checkbox",
        "id": "coll_show_tags",
        "label": "Show ungrouped tags",
        "default": true
      },
      {
        "type": "header",
        "content": "Tag group 1"
      },
      {
        "type": "checkbox",
        "id": "show_tagfilt_custom1",
        "label": "Show",
        "default": false
      },
      {
        "type": "text",
        "id": "tagfilt_custom1_name",
        "label": "Name"
      },
      {
        "type": "text",
        "id": "tagfilt_custom1_tags",
        "label": "Tags to include",
        "info": "Separate with commas"
      },
      {
        "type": "header",
        "content": "Tag group 2"
      },
      {
        "type": "checkbox",
        "id": "show_tagfilt_custom2",
        "label": "Show",
        "default": false
      },
      {
        "type": "text",
        "id": "tagfilt_custom2_name",
        "label": "Name"
      },
      {
        "type": "text",
        "id": "tagfilt_custom2_tags",
        "label": "Tags to include",
        "info": "Separate with commas"
      },
      {
        "type": "header",
        "content": "Layout"
      },
      {
        "type": "range",
        "id": "coll_num_per_page_int",
        "min": 16,
        "max": 40,
        "step": 8,
        "label": "Number of products to show per page",
        "default": 16
      },
      {
        "type": "select",
        "id": "coll_gridstream_mode",
        "label": "Show products in a grid or a list",
        "options": [
          {
            "value": "grid",
            "label": "Grid"
          },
          {
            "value": "stream",
            "label": "List"
          }
        ],
        "default": "grid"
      },
      {
        "type": "checkbox",
        "id": "coll_gridstream_toggle",
        "label": "Show toggle for grid and list views",
        "default": true
      },
		{
          "type": "image_picker",
          "id": "icon-1",
          "label": "Image Mark 1"
        },
        {
          "type": "html",
          "id": "text_icon-1",
          "label": "Text 1"
        },
		{
          "type": "image_picker",
          "id": "icon-2",
          "label": "Image Mark 2"
        },
        {
          "type": "html",
          "id": "text_icon-2",
          "label": "Text 2"
        },
		{
          "type": "image_picker",
          "id": "icon-3",
          "label": "Image Mark 3"
        },
        {
          "type": "html",
          "id": "text_icon-3",
          "label": "Text 3"
        },
		{
          "type": "image_picker",
          "id": "icon-4",
          "label": "Image Mark 4"
        },
        {
          "type": "html",
          "id": "text_icon-4",
          "label": "Text 4"
        },
		{
          "type": "image_picker",
          "id": "icon-5",
          "label": "Image Mark 5"
        },
        {
          "type": "html",
          "id": "text_icon-5",
          "label": "Text 5"
        },
        {
          "type": "checkbox",
          "id": "banner-visible",
          "label": "Display Banner"
        },
        {
          "type": "html",
          "id": "promobanner-copy",
          "label": "Banner Copy"
        }
    ]
  }
{% endschema %}
